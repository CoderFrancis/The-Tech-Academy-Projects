(window.editorJsonp=window.editorJsonp||[]).push([[39],{"Apy+":function(e,t,r){"use strict";r.r(t);var n=r("cDcd"),a=r("rtRr"),i=r.n(a),s=r("33BR"),o=r("dwxX");function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return e.slice(e.lastIndexOf(".")+1)}class l{constructor(e,t){p(this,"_eventTracker",void 0),p(this,"_defaultData",void 0),p(this,"_handleClick",e=>{let t,r=e.target,n=!1;for(;!t&&r;)"getAttribute"in r&&(t=r.getAttribute("data-event"),t||(t=r.getAttribute("data-traffic2"),t&&(n=!0))),r=r.parentNode;if(t)if(n){const r=c(t);"click"===r&&this.track(t,r,null,e)}else this.track(t,"click",null,e)}),this._eventTracker=i()({...e,app:"eventLogger-"+parseInt(1e17*Math.random()+Date.now(),10).toString(32)}),window.tccListenerDisabled=!0,t&&s.gtm.configure({})}setDefaultData(e){this._defaultData=e}updateGAData(e){const t=window._gaDataLayer;Object.keys(e).forEach(r=>{const n=e[r];n&&t&&!t.find(e=>e[r])&&t.push({[r]:n})})}track(e,t,r,n){const a=Object.assign({},this._defaultData,r);this._eventTracker.track(e,t,a,n)}logPageview(){this._eventTracker.logPageview()}setAlias(e){this._eventTracker.aliasToUser(e)}setSuperProperties(e){this._eventTracker.superProperties(e)}setUserProperties(e,t=!1){this._eventTracker.addMixpanelUserProperties(e,t)}updateEventMap(e){this._eventTracker.updateEventMap(e)}startCapturingClickEvents(){window.document.addEventListener("click",this._handleClick)}stopCapturingClickEvents(){window.document.removeEventListener("click",this._handleClick)}}function u(e){(window._expDataLayer=window._expDataLayer||[]).push(e)}const d={logEvent(e){const{code:t,type:r,domEvent:n,domNode:a,...i}=e,s=r||c(t),o=a&&!n?{target:a}:n;return g().track(t,s,i,o)},logConversion(e,t={}){u({version:"v1",schema:"add_generic_conversion",data:{...e,properties:t}})},logImpression(e,t={}){d.logEvent({...t,code:e,type:"impression"})},logPageView(e){const{location:t}=window,r=!e&&t?t.pathname+t.search+t.hash:e;r&&(u({version:"v1",schema:"add_page_request",data:{virtual_path:r}}),g().logPageview())},logVirtualPagePerf(e){u({version:"v1",schema:"add_perf",data:{type:"pageperf",properties:e}})},setAlias(e){g().setAlias(e)},setSuperProperties(e){g().setSuperProperties(e)},setUserProperties(e,t=!1){g().setUserProperties(e,t)},updateEventMap(e){g().updateEventMap(e)},trackWhenInitialized(...e){const t=e.length>=3?e[1]:"impression",r=e.length>=3?e[2]:e[1];g().track(e[0],t,r,e[3])}};let f;function g(){if(!f)throw new Error("`logger` was not initialized yet.");return f}function v(){return!!f}function h(e){if("undefined"==typeof window)return;if(v())return void console.warn("Can't initialize event-logger more than once.");const{userAnalytics:t,defaultData:r,gaData:n,initGTM:a}=e;f=new l(t,Boolean(a)),f.setDefaultData(r),f.updateGAData(n||{}),Object(o.a)(d)}function m(e,t){const r=Object.keys(t).filter(r=>t[r]!==e[r]);return r.length?r.reduce((e,r)=>Object.assign(e,{[r]:t[r]}),{}):null}h._destroy_logger_for_test_only=()=>{f=null};class w extends n.Component{UNSAFE_componentWillMount(){const{app:e,accountId:t,shopperId:r,resellerId:n,serverName:a,traffic2:i,mixpanelIdentifier:s,mixpanelToken:o,mixpanelRerouteToken:p,mixpanelSuperProperties:c,mixpanelConfig:l,eventMap:u,debug:d,initWithPageview:f,initGTM:g,logTraffic2EventsToMixpanel:v}=this.props;h({initGTM:g,userAnalytics:{app:e,traffic2:i,shopperId:r,eventMap:u,initWithPageview:f,debug:d,mixpanel:o?{token:o,rerouteToken:p,identifier:s||t,superProperties:c,config:l}:null,logTraffic2EventsToMixpanel:v},gaData:{account_uid:t,shopperId:r,server:a,privateLabelId:n},defaultData:this.getDefaultData(this.props)})}componentDidMount(){const{mixpanelUserProperties:e}=this.props;g().startCapturingClickEvents(),v()&&e&&g().setUserProperties(e)}UNSAFE_componentWillReceiveProps(e){if(!v())return;const{accountId:t,shopperId:r,resellerId:n,serverName:a,mixpanelSuperProperties:i,mixpanelUserProperties:s}=e,o=g();if(o.updateGAData({account_uid:t,shopperId:r,server:a,privateLabelId:n}),o.setDefaultData(this.getDefaultData(e)),i){const e=m(this.props.mixpanelSuperProperties||{},i);e&&o.setSuperProperties(e)}if(s){const e=m(this.props.mixpanelUserProperties||{},s);e&&o.setUserProperties(e)}}componentWillUnmount(){g().stopCapturingClickEvents()}shouldComponentUpdate(){return!1}getDefaultData(e){const{accountId:t,defaultData:r}=e;return t?Object.assign({account_uid:t},r):r}render(){return null}}var _,k,P;P={app:"eventLoggerTest",traffic2:!0,initWithPageview:!1,initGTM:!0},(k="defaultProps")in(_=w)?Object.defineProperty(_,k,{value:P,enumerable:!0,configurable:!0,writable:!0}):_[k]=P;t.default=w}}]);
//# sourceMappingURL=https://blobby.test-wsimg.com/go/static/editor/event-logger.f917237c598a2fa22002.c.js.map