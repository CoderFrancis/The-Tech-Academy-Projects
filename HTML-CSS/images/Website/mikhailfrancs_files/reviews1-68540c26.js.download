define("@widget/REVIEWS/reviews1-68540c26.js",["exports","@wsb/guac-widget-shared@^1/lib/components/Carousel"],(function(e,t){"use strict";function a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},o.apply(this,arguments)}const r="facebook",l="yelp",n="gmb",i="yotpo",s="manual",c={facebook:"REVIEWS_FB_CONNECT_CLICKED",yelp:"REVIEWS_YELP_CONNECT_CLICKED",gmb:"REVIEWS_GMB_CONNECT_CLICKED",yotpo:"REVIEWS_YOTPO_CONNECT_CLICKED"},g={facebook:"facebook2",yelp:"yelpLogoNegative",gmb:"gmb",yotpo:"yotpo"},p={facebook:"facebook",yelp:"yelpLogoNegative",gmb:"gmb",yotpo:"yotpo"},d={facebook:"fb",yelp:"yelp",gmb:"gmb",yotpo:"yotpo"},u={positive:"fbRecommends",negative:"fbDoesNotRecommend"},b={positive:"recommends",negative:"doesNotRecommend"},m={facebook:"Facebook",gmb:"Google My Business",yelp:"Yelp",yotpo:"Yotpo"},h={facebook:"https://graph.facebook.com/v3.0/{id}/picture?height=100&width=100"},y={base:{facebook:"https://facebook.com",gmb:"https://maps.google.com",yelp:"https://www.yelp.com/biz"},photo:{facebook:"https://graph.facebook.com/v3.0/{id}/picture"}},E="NOT_SETUP",w="LOADING",R="HAS_REVIEWS",v="FAILED",C="NO_REVIEWS",T="CONNECTED",f="NOT_CONNECTED",N={reseller:{local:"dev-secureserver.net",development:"dev-secureserver.net",test:"test-secureserver.net",production:"secureserver.net"},godaddy:{local:"dev-godaddy.com",development:"dev-godaddy.com",test:"test-godaddy.com",production:"godaddy.com"}},I="LEFT",D="RIGHT",P={facebook:"https://dashboard.{rootDomain}/fbPageCreate/{accountId}?home={home}",gmb:"https://dashboard.{rootDomain}/account/{accountId}/gmb",yelp:"https://dashboard.{rootDomain}/account/{accountId}/yelp",yotpo:"https://{websiteId}.onlinestore.{rootDomain}/admin/general_settings/edit#reviews"},x={yotpo:"https://launch.{rootDomain}/?account_uid={accountId}&path=plans"},{PropTypes:S}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var O={__proto__:null,planType:S.string.readOnly,market:S.string.readOnly,publishDate:S.string.readOnly,fbPageId:S.string.readOnly,fontScale:S.string.readOnly,gmbShowPendingMessage:S.bool.readOnly,publishAfterLastUpgrade:S.bool.readOnly,notice:S.any.kind("Notice"),providerType:S.Select,isInternalPage:S.bool.readOnly,isReseller:S.bool.readOnly,accountId:S.string.readOnly,order:S.number.readOnly,renderMode:S.string.readOnly,viewDevice:S.string.readOnly,sectionTitle:S.Text.maxCount(60),background:S.Image,env:S.string.readOnly,staticContent:S.object.readOnly,widgetType:S.string.readOnly,id:S.string.readOnly,websiteId:S.string.readOnly,pageId:S.string.readOnly,sourceType:S.RadioGroup,manualReviews:S.arrayOf(S.shape({photo:S.Image,title:S.Text.maxCount(25),body:S.Text.maxCount(200),rating:S.Select,name:S.Text.maxCount(25),date:S.Text.maxCount(15),link:S.Text})).kind("OrderableArray").maxCount(9)};const k="/reviews",_="gmbStatusResponse",M="apiRequestResponseData",U={PUBLISHED:"PUBLISHED",DUPLICATE:"DUPLICATE",PENDING:"PENDING",UNKNOWN:"UNKNOWN"},W="dynamic",A="static",B={ROUTE:"/reviews/$",PATH:k,PHOTO:"/reviews/$/photo"},{selectors:L}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,X=L.utils.createSelector(L.Stores.Website.property("planChangeDate"),L.Stores.Website.property("lastPublishSuccessUtcDateTime"),((e,t)=>!(!e||!t)&&new Date(e)>new Date(t))),H=L.utils.createSelector(L.Stores.Website.property("apiRequestResponseData"),(e=>(e=>{if(!e)return U.UNKNOWN;let t;try{t=JSON.parse(e)}catch(e){return U.UNKNOWN}return(global._||guac.lodash).get(t,"gmbStatusResponse.status",U.UNKNOWN)})(e)===U.PENDING)),{selectors:j}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,V=r,F=[r,n,l,i],G=j.I18N.get("defaultSectionTitle"),$={image:j.StockPhotos.index((global._||guac.lodash).random(5))},z=j.Plan.id,q=j.Account.market,K=j.Website.firstPublishDate,J=j.Page.isInternal,Y=j.Reseller.isReseller,Z=j.Account.id,Q=j.Config.viewDevice,ee=j.I18N.staticContent,te=j.Config.renderMode,ae=j.Config.env,oe=j.Website.id,re=j.utils.createSelector(j.Config.campaign,(e=>e&&F.includes(e)?e:V)),le=j.Stores.Website.property("fbPageId"),ne=j.utils.createSelector(j.Stores.Website.property("fontScale"),(e=>e||"medium")),ie=j.utils.createSelector(X,j.Stores.Widget.property("providerType"),((e,t)=>t===i&&e)),se=H,ce=j.utils.createSelector(j.Config.campaign,(e=>e&&e===s?A:W)),ge=j.utils.createSelector(j.I18N.get("reviewTitle"),j.I18N.get("reviewBody"),j.I18N.get("anonymous"),j.Account.market,((e,t,a,o)=>{const r=(new Date).toLocaleDateString(o);return[{photo:{},title:`${e} 1`,body:`${t} 1`,rating:"0",name:a,date:r},{photo:{},title:`${e} 2`,body:`${t} 2`,rating:"0",name:a,date:r},{photo:{},title:`${e} 3`,body:`${t} 3`,rating:"0",name:a,date:r}]}));var pe={__proto__:null,sectionTitle:G,background:$,planType:z,market:q,publishDate:K,isInternalPage:J,isReseller:Y,accountId:Z,viewDevice:Q,staticContent:ee,renderMode:te,env:ae,websiteId:oe,providerType:re,fbPageId:le,fontScale:ne,publishAfterLastUpgrade:ie,gmbShowPendingMessage:se,sourceType:ce,manualReviews:ge};const de=(global.Core||guac["@wsb/guac-widget-core"]).Maniless.constants.routes.BASE,ue="/imagePivot",{selectors:be}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,me=[i,n,l],he={photo:{borderRadius:"50%",width:"24px",height:"24px"},text:{width:"24px",height:"24px",fontSize:"18px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"rgba(48, 51, 58, 0.5)",backgroundColor:"rgba(240, 240, 240, 0.8)"}},ye=be.utils.createSelector(be.Stores.Widget.property("sourceType"),be.Stores.Widget.property("providerType"),be.Website.firstPublishDate,X,be.I18N.get("publishNow"),be.I18N.get("yotpoPublishMessage"),be.I18N.get("yelpPublishMessage"),be.I18N.get("gmbPublishMessage"),((e,t,a,o,r,s,c,g)=>{if(e===A)return{hidden:!0};const p={[i]:s,[l]:c,[n]:g};let d=!0;return!a&&me.includes(t)&&(d=!1),t===i&&d&&(d=!o),{messageType:"warning",buttonLabel:r,message:p[t],hidden:d,trafficKey:t}})),Ee=be.utils.createSelector(be.Stores.Widget.data("background"),be.Stores.Widget.property("backgroundImage"),((e,t)=>{const a=be.utils.getWithProp(e,"image")||t;return a?(global.React||guac.react).createElement("img",{className:"mx-pivot-icon",src:a}):null})),we={label:be.I18N.get("image")},Re={label:be.I18N.get("titleForSectionTitleProp")},ve={options:be.utils.createSelector(be.Config.flag("reviewsProvider"),(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((e=>({label:m[e],value:e})))})),hidden:be.utils.createSelector(be.Stores.Widget.property("sourceType"),(e=>e===A))},Ce={label:be.I18N.get("connectedAccount"),description:be.I18N.get("buildMoreTrust")},Te={label:be.I18N.get("deleteSectionButton")},fe={to:ue,label:be.I18N.get("titleForBackgroundImage"),graphic:Ee},Ne={label:be.I18N.get("photo"),getProps(e){const t=e.getFieldValue("manualReviews.photo"),a=e.getFieldValue("manualReviews.name"),o=a&&a.length&&a.charAt(0)||"";return{to:e.getRoute(B.PHOTO),graphic:t&&t.image?(global.React||guac.react).createElement("img",{style:he.photo,src:t.image,alt:"",className:"mx-pivot-icon"}):(global.React||guac.react).createElement("div",{style:he.text,className:"mx-pivot-icon",children:o})}}},Ie={savePropertyName:"gmbStatusResponse",url:be.utils.createSelector(be.Config.rootDomain,be.Account.id,((e,t)=>`https://proxy.apps-api.instantpage.${e}/v1/proxy/social?accountId=${t}`)),sendAuthCookies:!0,providerType:be.Stores.Widget.property("providerType"),currentStatus:be.Stores.Website.property("apiRequestResponseData"),linkTitle:be.I18N.get("gmbConnect"),connectUrl:be.utils.createSelector(be.Config.rootDomain,be.Account.id,((e,t)=>`https://dashboard.${e}/account/${t}/gmb`)),hidden:be.utils.createSelector(be.Stores.Widget.property("sourceType"),be.Website.firstPublishDate,((e,t)=>e===A||!t))},De={messageType:"help",message:be.I18N.get("gmb3Days"),hidden:be.utils.createSelector(be.Stores.Widget.property("sourceType"),be.Config.viewDevice,H,((e,t,a)=>e===A||"TABLET_RENDER_DEVICE"===t||!a))},Pe=X,xe=H,Se={options:be.utils.createSelector(be.I18N.get("sourceMsgStatic"),be.I18N.get("sourceMsgDynamic"),((e,t)=>[{label:t,value:W},{label:e,value:A}])),defaultValue:W,widgetType:"REVIEWS"},Oe={label:be.I18N.get("reviewTitle")},ke={label:be.I18N.get("reviewBody"),multiline:!0},_e={label:be.I18N.get("reviewerName")},Me={label:be.I18N.get("reviewDate")},Ue={label:be.I18N.get("reviewLink")},We={options:[{label:be.I18N.get("ratingNone"),value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"}],label:be.I18N.get("reviewRating"),defaultValue:"0"},Ae={label:be.I18N.get("manualReviews"),maxCount:9,hidden:be.utils.createSelector(be.Stores.Widget.property("sourceType"),(e=>e!==A)),to:B.ROUTE,getProps:e=>e&&e.value&&(global._||guac.lodash).isArray(e.value)?{items:e.value.map(((e,t)=>({to:`${B.PATH}/${t}`,label:e.title||"",description:e.body||"",graphic:null})))}:{}},Be={label:be.I18N.get("labelForDeleteManualReview"),field:"manualReviews",atIndex:!0,to:"/"},Le=e=>{let{providerType:t,url:a,currentStatus:o,linkTitle:r,connectUrl:l,onChange:i}=e;if(t===n){let e={};if(o)try{e=JSON.parse(o)}catch(t){e={}}((e,t)=>{window.fetch(e,{headers:{Accept:"application/json"},credentials:"include"}).then((e=>e.json())).then(t).catch((()=>t({})))})(a,(t=>{const a=(e=>{if(!e)return{status:U.UNKNOWN};const t=e&&e.gmb||{},a=Object.keys(t)&&Object.keys(t)[0]||null;return{status:a&&t[a]&&t[a].status||U.UNKNOWN}})(t);if(a.status!==U.UNKNOWN&&(global._||guac.lodash).get(e,`${_}.status`,U.UNKNOWN)!==a.status){const e={[_]:a},t={website:{properties:{[M]:JSON.stringify(e)}}};i(t)}}));const t=(global._||guac.lodash).get(e,`${_}.status`,U.UNKNOWN);if(![U.PENDING,U.PUBLISHED,U.DUPLICATE].includes(t))return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).Maniless.Elements.Fieldset,{className:"mx-gmb-external-link",style:{cursor:"pointer"}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).Maniless.Fields.ExternalLink,{openAsNewTab:!1,linkText:r,showAsLink:!0,link:l}))}return null};Le.propTypes={url:(global.PropTypes||guac["prop-types"]).string,providerType:(global.PropTypes||guac["prop-types"]).string,currentStatus:(global.PropTypes||guac["prop-types"]).string,linkTitle:(global.PropTypes||guac["prop-types"]).string,connectUrl:(global.PropTypes||guac["prop-types"]).string,onChange:(global.PropTypes||guac["prop-types"]).func.isRequired};class Xe extends(global.React||guac.react).Component{render(){const{messageType:e,buttonLabel:t,message:a,trafficKey:o,widgetType:r,setRoute:l}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).Maniless.Elements.Fieldset,{className:"mx-publish"},a&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).Maniless.Fields.NotifyMessage,{messageType:e,message:a}),t&&(global.React||guac.react).createElement("div",{style:{marginTop:"1.5rem"}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).Maniless.Fields.ExternalLink,{link:(global.Core||guac["@wsb/guac-widget-core"]).Maniless.constants.routes.PUBLISH,linkText:t,showAsLink:!1,isRoute:!0,id:o,widgetType:r,setRoute:l})))}}a(Xe,"propTypes",{messageType:(global.PropTypes||guac["prop-types"]).string,buttonLabel:(global.PropTypes||guac["prop-types"]).string,message:(global.PropTypes||guac["prop-types"]).string,widgetType:(global.PropTypes||guac["prop-types"]).string,trafficKey:(global.PropTypes||guac["prop-types"]).string,setRoute:(global.PropTypes||guac["prop-types"]).func.isRequired});const{PropTypes:He}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,je="deleteSectionButton",Ve="imagePivot",Fe="publishButton",Ge="gmbExternalLink",$e="deleteManualReviewButton",ze="reviewerPhotoPivot";var qe={[je]:He.DeleteButton,[Ve]:He.Pivot,[Fe]:He.any.kind(Xe),notifyMsg:He.any.kind("NotifyMessage"),[Ge]:He.any.kind(Le),notice:He.any.kind("Notice"),[$e]:He.DeleteButton,[ze]:He.Pivot};const{Widget:Ke}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var Je=Ke.keys(O);const{Mutator:Ye,Widget:Ze}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,Qe=Ze.keys();class et extends Ye{}a(et,"fields",Ye.mergeFields(qe)),a(et,"defaultProps",{...Ye.defaultProps,[ue]:we,[Je.sectionTitle]:Re,[Je.background]:{enableFocalSelector:!0,showRemoveButton:!0,showOverlayOpacityControls:!0,addOrReplaceImage:!0},[Ge]:Ie,[Je.notice]:Ce,[Je.sourceType]:Se,[Je.manualReviews]:Ae,[ze]:Ne,[Je.manualReviews.photo]:{showRemoveButton:!0,showOverlayOpacityControls:!1,addOrReplaceImage:!0,aspectRatio:1},[Je.manualReviews.title]:Oe,[Je.manualReviews.body]:ke,[Je.manualReviews.rating]:We,[Je.manualReviews.name]:_e,[Je.manualReviews.date]:Me,[Je.manualReviews.link]:Ue,[Je.providerType]:ve,[Je.fbPageId]:void 0,[Fe]:ye,[Je.gmbPendingMessage]:De,[Je.gmbShowPendingMessage]:xe,[Je.publishAfterLastUpgrade]:Pe,[je]:Te,[$e]:Be,[Ve]:fe,routes:{[de]:[Qe.category,Je.sectionTitle,Ve,Je.notice,Je.sourceType,Je.providerType,Je.manualReviews,Ge,Fe,Je.gmbPendingMessage,Je.fbPageId,Je.gmbShowPendingMessage,Je.publishAfterLastUpgrade,je],[ue]:[Je.background],[B.ROUTE]:[ze,Je.manualReviews.title,Je.manualReviews.body,Je.manualReviews.rating,Je.manualReviews.name,Je.manualReviews.date,Je.manualReviews.link,$e],[B.PHOTO]:[Je.manualReviews.photo]}});var tt=(global.keyMirror||guac.keymirror)({REVIEWS_SECTION_TITLE_RENDERED:null,REVIEWS_NO_DATA_RENDERED:null,REVIEWS_NOT_CONNECTED_MSG:null,PENDING_VALIDATION_HEADER:null,PENDING_VALIDATION_CONTENT:null,WAITING_FOR_DATA_HEADER:null,WAITING_FOR_DATA_CONTENT:null,SECTION_BACKGROUND:null,REVIEWS_BUSINESS_NAME_RENDERED:null,REVIEWS_CONNECT_BUTTON:null,USER_REVIEW_RENDERED:null,STATIC_REVIEW_RENDERED:null,READ_MORE_RENDERED:null,PRODUCT_LINK_RENDERED:null,REVIEW_TITLE_RENDERED:null,REVIEWER_INFO_RENDERED:null,REVIEWER_INITIAL_RENDERED:null,REVIEWER_PHOTO_RENDERED:null,RECOMMENDATION_RENDERED:null,RECOMMENDATION_ICON_RENDERED:null,RECOMMENDATION_TEXT_RENDERED:null,RECOMMENDATION_DESC_RENDERED:null,RATING_RENDERED:null,LEFT_ARROW_RENDERED:null,RIGHT_ARROW_RENDERED:null,UPGRADE_TIER_MSG:null,REVIEWS_LOADER:null});const at={color:"section"},ot=[i],rt=[s],lt={topBar:{display:"flex",alignItems:"center",alignContent:"center",justifyContent:"center",cursor:"pointer",marginBottom:"large","@xs-only":{boxShadow:"none",justifyContent:"center"},"@sm":{justifyContent:"center"}},overallRating:{marginLeft:"small"},ratingStar:{backgroundColor:"transparent",marginHorizontal:"medium","@md":{marginHorizontal:"0px"}},overallRatingContainer:{display:"flex",flexDirection:"column",marginLeft:"small"},overallReviews:{lineHeight:"normal",marginTop:"xxsmall"},recommended:{fontWeight:"bold",lineHeight:"normal"},mobileTopBarContainer:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"0"},businessName:{marginBottom:"xxsmall",lineHeight:"normal"},pageLink:{display:"block",color:"section",":hover":at,":visited":at,textTransform:"none"},pageLinkContainer:{padding:"0",marginBottom:"medium",textAlign:"center"}};class nt extends(global.React||guac.react).Component{generateReviewBarStyles(){const{provider:e}=this.props;return{linkProps:{tag:"a",target:ot.includes(e)?"_self":"_blank",rel:ot.includes(e)?"alternate":"noopener",style:{display:"block"}}}}getBusinessNameBlock(){const{businessName:e}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text.Major,{"data-aid":tt.REVIEWS_BUSINESS_NAME_RENDERED,style:lt.businessName,children:e})}getRecommendationPercentage(){const{positiveRecommendations:e,negativeRecommendations:t}=this.props;return e>0?Math.ceil(100*e/(e+t)):0}getMobileRatingBar(){const{provider:e,overallRating:t,positiveRecommendations:a,staticContent:o,negativeRecommendations:l}=this.props;if(e===r&&a>0){const e=this.getRecommendationPercentage(),t=a+l;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{"data-aid":tt.RECOMMENDATION_RENDERED,style:{...lt.topBar,flexDirection:"column"}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text.Major,{"data-aid":tt.RECOMMENDATION_TEXT_RENDERED,style:lt.recommended},o.percentRecommend.replace("{percent}",`${e}%`)),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{"data-aid":tt.RECOMMENDATION_DESC_RENDERED,style:{...lt.overallReviews,textAlign:"center",marginBottom:"small"}},1===t?o.basedOnOne:o.basedOn.replace("{reviewCount}",t)))}return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:lt.topBar},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Heading.Major,{style:lt.overallRating},t.toFixed(1)),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Rating,{"data-aid":tt.RATING_RENDERED,rating:t,style:lt.ratingStar}))}getDesktopRatingBar(){const{provider:e,positiveRecommendations:t,negativeRecommendations:a,overallRating:o,totalReviews:l,staticContent:n}=this.props;let s=1===l?n.review:n.reviews;if(e===i&&(s=1===l?n.productReview:n.productReviews),e===r&&t>0){const e=this.getRecommendationPercentage(),o=t+a;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{"data-aid":tt.RECOMMENDATION_RENDERED,style:lt.overallRatingContainer},this.getBusinessNameBlock(),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text.Major,{"data-aid":tt.RECOMMENDATION_TEXT_RENDERED,style:lt.recommended},n.percentRecommend.replace("{percent}",`${e}%`)),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{"data-aid":tt.RECOMMENDATION_DESC_RENDERED,style:lt.overallReviews},1===o?n.basedOnOne:n.basedOn.replace("{reviewCount}",o)))}return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:lt.overallRatingContainer},this.getBusinessNameBlock(),o>0&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Rating,{"data-aid":tt.RATING_RENDERED,rating:o,style:lt.ratingStar}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{style:lt.overallReviews},s.replace("{totalReviews}",l)))}render(){const{provider:e,overallRating:t,totalReviews:a,businessName:l,positiveRecommendations:n,negativeRecommendations:s,pageLink:c,staticContent:p,isMobile:d,hasBgImage:u,category:b,section:m}=this.props;if(rt.includes(e))return null;const h=this.generateReviewBarStyles();h.linkProps.href=c;const y=e===i?p.viewAllProductReviews:p.viewAllReviews,E=e===r&&n>0?n+s:a;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{category:u?"accent":b,section:u?"overlay":m},!d&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Element,o({},h.linkProps,{style:{"text-decoration-line":"none"}}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:lt.topBar},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{marginTop:"xxsmall"}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:g[e],size:"xlarge"})),e!==r&&t>0&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Heading.Major,{style:lt.overallRating},t.toFixed(1)),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:lt.overallRatingContainer},this.getDesktopRatingBar()))),d&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{style:lt.mobileTopBarContainer},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text.Major,{"data-aid":tt.REVIEWS_BUSINESS_NAME_RENDERED,style:{marginBottom:"xxsmall",textAlign:"center"},children:l}),this.getMobileRatingBar(),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{style:lt.pageLinkContainer},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Element,{tag:"a",target:"_blank",href:c,style:lt.pageLink},y.replace("{totalReviews}",1===E?"":E)))))}}a(nt,"propTypes",{provider:(global.PropTypes||guac["prop-types"]).string,overallRating:(global.PropTypes||guac["prop-types"]).number,totalReviews:(global.PropTypes||guac["prop-types"]).number,isMobile:(global.PropTypes||guac["prop-types"]).bool,pageLink:(global.PropTypes||guac["prop-types"]).string,staticContent:(global.PropTypes||guac["prop-types"]).object.isRequired,hasBgImage:(global.PropTypes||guac["prop-types"]).bool,businessName:(global.PropTypes||guac["prop-types"]).string,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,positiveRecommendations:(global.PropTypes||guac["prop-types"]).number,negativeRecommendations:(global.PropTypes||guac["prop-types"]).number}),a(nt,"defaultProps",{provider:r,overallRating:0,totalReviews:0});var it=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},st=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}();function ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var pt=function(e){function t(){var e;ct(this,t);for(var a=arguments.length,o=Array(a),r=0;r<a;r++)o[r]=arguments[r];var l=gt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o)));return l.state={},l.styles={ellipsis:{position:"fixed",visibility:"hidden",top:0,left:0}},l.elements={},l.onResize=l.onResize.bind(l),l.onTruncate=l.onTruncate.bind(l),l.calcTargetWidth=l.calcTargetWidth.bind(l),l.measureWidth=l.measureWidth.bind(l),l.getLines=l.getLines.bind(l),l.renderLine=l.renderLine.bind(l),l}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,(global.React||guac.react).Component),st(t,[{key:"componentDidMount",value:function(){var e=this.elements.text,t=this.calcTargetWidth,a=this.onResize,o=document.createElement("canvas");this.canvasContext=o.getContext("2d"),t((function(){e&&e.parentNode.removeChild(e)})),window.addEventListener("resize",a)}},{key:"componentDidUpdate",value:function(e){this.props.children!==e.children&&this.forceUpdate(),this.props.width!==e.width&&this.calcTargetWidth()}},{key:"componentWillUnmount",value:function(){var e=this.elements.ellipsis,t=this.onResize,a=this.timeout;e.parentNode.removeChild(e),window.removeEventListener("resize",t),window.cancelAnimationFrame(a)}},{key:"innerText",value:function(e){var t=document.createElement("div"),a="innerText"in window.HTMLElement.prototype?"innerText":"textContent";t.innerHTML=e.innerHTML.replace(/\r\n|\r|\n/g," ");var o=t[a],r=document.createElement("div");return r.innerHTML="foo<br/>bar","foo\nbar"!==r[a].replace(/\r\n|\r/g,"\n")&&(t.innerHTML=t.innerHTML.replace(/<br.*?[\/]?>/gi,"\n"),o=t[a]),o}},{key:"onResize",value:function(){this.calcTargetWidth()}},{key:"onTruncate",value:function(e){var t=this.props.onTruncate;"function"==typeof t&&(this.timeout=window.requestAnimationFrame((function(){t(e)})))}},{key:"calcTargetWidth",value:function(e){var t=this.elements.target,a=this.calcTargetWidth,o=this.canvasContext,r=this.props.width;if(t){var l=r||Math.floor(t.parentNode.getBoundingClientRect().width);if(!l)return window.requestAnimationFrame((function(){return a(e)}));var n=window.getComputedStyle(t),i=[n["font-weight"],n["font-style"],n["font-size"],n["font-family"]].join(" ");o.font=i,this.setState({targetWidth:l},e)}}},{key:"measureWidth",value:function(e){return this.canvasContext.measureText(e).width}},{key:"ellipsisWidth",value:function(e){return e.offsetWidth}},{key:"trimRight",value:function(e){return e.replace(/\s+$/,"")}},{key:"getLines",value:function(){for(var e=this.elements,t=this.props,a=t.lines,o=t.ellipsis,r=t.trimWhitespace,l=this.state.targetWidth,n=this.innerText,i=this.measureWidth,s=this.onTruncate,c=this.trimRight,g=[],p=n(e.text).split("\n").map((function(e){return e.split(" ")})),d=!0,u=this.ellipsisWidth(this.elements.ellipsis),b=1;b<=a;b++){var m=p[0];if(0!==m.length){var h=m.join(" ");if(i(h)<=l&&1===p.length){d=!1,g.push(h);break}if(b===a){for(var y=m.join(" "),E=0,w=y.length-1;E<=w;){var R=Math.floor((E+w)/2);i(y.slice(0,R+1))+u<=l?E=R+1:w=R-1}var v=y.slice(0,E);if(r)for(v=c(v);!v.length&&g.length;){v=c(g.pop())}h=(global.React||guac.react).createElement("span",null,v,o)}else{for(var C=0,T=m.length-1;C<=T;){var f=Math.floor((C+T)/2);i(m.slice(0,f+1).join(" "))<=l?C=f+1:T=f-1}if(0===C){b=a-1;continue}h=m.slice(0,C).join(" "),p[0].splice(0,C)}g.push(h)}else g.push(),p.shift(),b--}return s(d),g}},{key:"renderLine",value:function(e,t,a){if(t===a.length-1)return(global.React||guac.react).createElement("span",{key:t},e);var o=(global.React||guac.react).createElement("br",{key:t+"br"});return e?[(global.React||guac.react).createElement("span",{key:t},e),o]:o}},{key:"render",value:function(){var e=this,t=this.elements.target,a=this.props,o=a.children,r=a.ellipsis,l=a.lines,n=function(e,t){var a={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(a[o]=e[o]);return a}(a,["children","ellipsis","lines"]),i=this.state.targetWidth,s=this.getLines,c=this.renderLine,g=this.onTruncate,p=void 0;return"undefined"!=typeof window&&!(!t||!i)&&(l>0?p=s().map(c):(p=o,g(!1))),delete n.onTruncate,delete n.trimWhitespace,(global.React||guac.react).createElement("span",it({},n,{ref:function(t){e.elements.target=t}}),(global.React||guac.react).createElement("span",null,p),(global.React||guac.react).createElement("span",{ref:function(t){e.elements.text=t}},o),(global.React||guac.react).createElement("span",{ref:function(t){e.elements.ellipsis=t},style:this.styles.ellipsis},r))}}]),t}();pt.propTypes={children:(global.PropTypes||guac["prop-types"]).node,ellipsis:(global.PropTypes||guac["prop-types"]).node,lines:(global.PropTypes||guac["prop-types"]).oneOfType([(global.PropTypes||guac["prop-types"]).oneOf([!1]),(global.PropTypes||guac["prop-types"]).number]),trimWhitespace:(global.PropTypes||guac["prop-types"]).bool,width:(global.PropTypes||guac["prop-types"]).number,onTruncate:(global.PropTypes||guac["prop-types"]).func},pt.defaultProps={children:"",ellipsis:"…",lines:1,trimWhitespace:!1,width:0};const dt=[i],ut=240,bt=240,mt={common:{display:"flex",flexGrow:"1",flexShrink:"0",flexBasis:"auto",flexDirection:"column",alignItems:"center",justifyContent:"space-between"},topContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},photoContainer:{width:"100px",height:"100px",borderRadius:"50%",backgroundColor:"rgba(240,240,240,0.8)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},photoStyles:{width:"100px",height:"100px",display:"inline-block"},firstInitial:{color:"#CBCBCB",lineHeight:"1",padding:"medium",fontSize:"xxxlarge"},reviewBodyContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingHorizontal:"medium",paddingVertical:"medium",textTransform:"none",flexGrow:2,width:"100%"},reviewTitle:{marginBottom:"small",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"normal"},sharedReviewContent:{lineHeight:"1.3",minHeight:"42px"},fullReviewOverlay:{overflowY:"auto",height:"100%"},reviewerContainer:{paddingHorizontal:"medium",width:"100%",display:"flex",justifyContent:"center",alignItems:"center","@xs-only":{marginTop:"0"}},reviewer:{paddingHorizontal:"small",fontSize:"xsmall",lineHeight:"normal"},recommendationContainer:{paddingTop:"medium",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},icons:{facebook:{color:"#4267B2",height:"25px",width:"25px"},recommendation:{width:"20px"}},fullReview:{position:"absolute",width:"100%",height:"100%",top:"100%",opacity:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"action",color:"action",padding:"small",transition:"all 0.3s ease","@md":{padding:"medium"}},fullReviewHover:{overflow:"hidden","@md":{":hover":{".fullreview":{opacity:1,top:0,zIndex:1}}}},fullReviewClose:{position:"absolute",top:"16px",right:"16px",cursor:"pointer"},fullReviewOverlayShowOnMobile:{opacity:1,top:0,zIndex:1},linkContainer:{marginTop:"small"},ratingStars:{marginTop:"medium","@xs-only":{marginTop:"small"}}},ht=[r,l,i,n],yt=[s],Et=[i],wt=["positive","negative"];class Rt extends(global.React||guac.react).Component{constructor(){super(...arguments),this.state={truncated:!1,imageFailed:!1,showFullReviewOverlay:!1,showExternalLink:!1},this.handleTruncate=this.handleTruncate.bind(this),this.toggleFullReviewOverlay=this.toggleFullReviewOverlay.bind(this),this.handleImageError=this.handleImageError.bind(this),this.getTotalReviewLines=this.getTotalReviewLines.bind(this),this.cardComponent=(global.React||guac.react).createRef()}handleTruncate(e){const{provider:t}=this.props;this.state.truncated!==e&&this.setState({truncated:e,showExternalLink:ht.includes(t)})}toggleFullReviewOverlay(){this.setState({showFullReviewOverlay:!this.state.showFullReviewOverlay})}handleImageError(){this.setState({imageFailed:!0})}getReviewerPhoto(e,t){const{sourceType:a}=this.props,{imageFailed:r}=this.state;let l,n;e.photo?n=e.photo:(l=e.imageData||{},n=l.image||"");let i=n&&(n.toLowerCase().startsWith("http")||n.startsWith("//"))?n:null;const s="dynamic"===a;e.metadata&&e.metadata.reviewerId&&h[t]&&(i=h[t].replace("{id}",e.metadata.reviewerId));const c=e.name?e.name.charAt(0).toUpperCase():null,g=s?{src:i}:{imageData:{...l,outputWidth:100,outputHeight:100}};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:mt.photoContainer},i&&!r&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Image.Thumbnail,o({tag:"img","data-aid":tt.REVIEWER_PHOTO_RENDERED,style:mt.photoStyles,onError:this.handleImageError},g)),(!i||r)&&c&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Heading,{"data-aid":tt.REVIEWER_INITIAL_RENDERED,children:c,style:mt.firstInitial}))}getRatingBlock(){const{provider:e,data:t,staticContent:a,renderMode:o}=this.props;if(e===r&&t.recommendation&&wt.includes(t.recommendation))return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{"data-aid":tt.RECOMMENDATION_RENDERED,style:mt.recommendationContainer},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{"data-aid":tt.RECOMMENDATION_ICON_RENDERED,icon:u[t.recommendation],style:mt.icons.recommendation}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{"data-aid":tt.RECOMMENDATION_TEXT_RENDERED,style:{paddingLeft:"small"}},a[b[t.recommendation]]));const l=e===s&&o!==(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.EDIT&&"0"===t.rating?"hidden":"visible";return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Rating,{"data-aid":tt.RATING_RENDERED,style:{...mt.ratingStars,visibility:l},rating:t.rating})}getTruncatedLine(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(global.React||guac.react).createElement(pt,{lines:1,ellipsis:a?'..."':"...",trimWhitespace:!0,width:e?ut:bt},`${t}`)}sanitizeLink(e,t){return dt.includes(t)||!e||e.startsWith("http")?e:`//${e}`}componentDidUpdate(e){const{data:t}=this.props,{data:a}=e;t.photo===a.photo&&(global._||guac.lodash).get(t,"imageData.image")===(global._||guac.lodash).get(a,"imageData.image")||this.setState({imageFailed:!1})}componentDidMount(){const e=this.cardComponent.current&&(global.ReactDOM||guac["react-dom"]).findDOMNode(this.cardComponent.current),t=e&&e.offsetWidth||0;this.setState({currentCardWidth:t})}getTotalReviewLines(e){const{isMobile:t,provider:a}=this.props,{currentCardWidth:o}=this.state;if(t||!t&&e)return 3;return o&&o<=300?2:a===s?4:3}render(){const{data:e,provider:t,isMobile:a,desktopMobilePreview:o,link:r,staticContent:l,market:n,cardHeight:i}=this.props,{truncated:c,showExternalLink:g,showFullReviewOverlay:d}=this.state,u=yt.includes(t)&&(global._||guac.lodash).get(e,"link",!1),b=c&&!(u||g),m=Et.includes(t)&&!!(e&&e.metadata&&e.metadata.product),h=Et.includes(t)?"0.6":"1",y=e&&e.metadata&&e.metadata.title||"",E=this.getTotalReviewLines(u),w=t===s,R={card:{textAlign:"center",borderWidth:"0px",textShadow:"none",position:"relative",boxShadow:"2px 6px 30px 0 rgba(0,0,0,0.18)",paddingVertical:"large",height:i,width:"290px","@xs-only":{paddingVertical:"medium"}}},v=b?mt.fullReviewHover:{},C=d?mt.fullReviewOverlayShowOnMobile:{};a&&(o||(R.card.minWidth="290px",R.card.width="auto"));let T=((e,t)=>{if(!e||!Date.parse(e))return"";if(/^\d{4}-\d{2}-\d{2}/.test(e)){const a=e.split(/\D+/).map((e=>parseInt(e,10)));return a[1]=a[1]-1,new Date(...a).toLocaleDateString(t)}return new Date(e).toLocaleDateString(t)})(e.date,n);return!T&&w&&e.date&&(T=e.date),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,null,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Group.Card,{ref:this.cardComponent,style:{...mt.common,...R.card,...v}},b&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{...mt.fullReview,...C},className:"fullreview",category:"accent",section:"overlay"},a&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:"close",style:mt.fullReviewClose,onClick:this.toggleFullReviewOverlay}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{children:e.body,style:{color:"action",...mt.sharedReviewContent,...mt.fullReviewOverlay}})),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{style:mt.topContainer},this.getReviewerPhoto(e,t),this.getRatingBlock()),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:mt.reviewBodyContainer},m&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,{"data-aid":tt.PRODUCT_LINK_RENDERED,target:"_self",href:this.sanitizeLink(e.link||r,t)},this.getTruncatedLine(a,e.metadata.product)),y&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Heading,{"data-aid":tt.REVIEW_TITLE_RENDERED,style:mt.reviewTitle},y),e.body&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{style:{...mt.sharedReviewContent,opacity:h},featured:!0},(global.React||guac.react).createElement(pt,{"data-aid":tt.USER_REVIEW_RENDERED,lines:E,ellipsis:'..."',trimWhitespace:!0,width:a?ut:bt,onTruncate:this.handleTruncate},`"${e.body}"`)),!e.body&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Details,{"data-aid":tt.STATIC_REVIEW_RENDERED},l.noWrittenReviews),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{...mt.linkContainer}},(u||g)&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.MoreLink.Forward,{"data-aid":tt.READ_MORE_RENDERED,target:m?"_self":"_blank",href:this.sanitizeLink(e.link||r,t)},l.readFullReview),a&&c&&!(u||g)&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,{tag:"span",onClick:this.toggleFullReviewOverlay,children:l.viewMore||"View More"}))),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:mt.reviewerContainer},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:p[t],size:"medium",style:mt.icons[t]}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Details.Minor,{"data-aid":tt.REVIEWER_INFO_RENDERED,tag:"p",style:mt.reviewer},(global.React||guac.react).createElement("strong",null,e.name,e.name&&T?" - ":""),T))))}}a(Rt,"propTypes",{data:(global.PropTypes||guac["prop-types"]).object.isRequired,provider:(global.PropTypes||guac["prop-types"]).string.isRequired,link:(global.PropTypes||guac["prop-types"]).string,isMobile:(global.PropTypes||guac["prop-types"]).bool,nextPageHandler:(global.PropTypes||guac["prop-types"]).func,previousPageHandler:(global.PropTypes||guac["prop-types"]).func,desktopMobilePreview:(global.PropTypes||guac["prop-types"]).bool,staticContent:(global.PropTypes||guac["prop-types"]).object,renderMode:(global.PropTypes||guac["prop-types"]).string.isRequired,market:(global.PropTypes||guac["prop-types"]).string,sourceType:(global.PropTypes||guac["prop-types"]).string,cardHeight:(global.PropTypes||guac["prop-types"]).string});const{MatchMedia:vt}=(global.Core||guac["@wsb/guac-widget-core"]).UX,Ct="290px",Tt=r,ft=[n,l],Nt=[i],It=["commerce","managedStandardCommerce"],Dt={small:430,medium:440,large:460,xlarge:480},Pt={container:{textAlign:"center",display:"flex",flexDirection:"column"},cardsContainer:{position:"relative"},arrow:{width:"medium",position:"absolute",top:"50%",zIndex:1,cursor:"pointer",color:"section",":hover":{color:"rgba(288, 288, 288, 0.6)"}},grid:{alignItems:"center",justifyContent:"center",flexWrap:"nowrap"},cell:{flexGrow:0},paginationContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:"xlarge"},pageDot:{width:"12px",height:"12px",borderRadius:"50%",margin:"xsmall",cursor:"pointer",backgroundColor:"sectionContrast",opacity:.6,boxShadow:"1px 2px 15px 0 rgba(0,0,0,0.18)"},selected:{opacity:1}};class xt extends(global.React||guac.react).Component{constructor(){super(...arguments),a(this,"handleMatchMedia",(e=>{const{viewDevice:t,renderMode:a}=this.props,o=a===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH?"xs"===e.size||"sm"===e.size:/mobile/i.test(t);let r=3;o?r=1:"md"===e.size&&(r=2),this.setState({isMobile:o,cardsPerPage:r,size:e.size})})),this.state={data:{},currentPage:1,pages:0,provider:Tt,state:w,isMobile:!1,cardsPerPage:3,dummyData:!1,planUpgradeRequired:!1}}updateCurrentPage(e){return()=>{this.setState({currentPage:e})}}gotoPage(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return()=>{const{currentPage:t,pages:a}=this.state;let o=t+(e?1:-1);e?o>a&&(o=1):o<1&&(o=a),this.setState({currentPage:o})}}getPageDotStyles(e){const{currentPage:t}=this.state;let a=Pt.pageDot;return t===e&&(a=(global._||guac.lodash).merge({},Pt.pageDot,Pt.selected)),a}fetchData(){const{renderMode:e,providerType:t,planType:a,sourceType:o,manualReviews:r,staticContent:l}=this.props;if(o===A)if(r.length){const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Anonymous";const a={totalReviews:e.length,reviews:[]};return e.length&&(global._||guac.lodash).each(e,(e=>{a.reviews.push({imageData:e.photo||{},name:e.name||t,date:e.date||"",rating:e.rating,body:e.body,link:e.link||null,metadata:{title:e.title}})})),a}(r,l.anonymous);this.setState({data:e,state:R}),this.updatePageCount(e)}else this.setState({state:C});else if(Nt.includes(t)&&!It.includes(a))this.setState({planUpgradeRequired:!0,state:E});else{this.setState({planUpgradeRequired:!1,state:w});const t=this.getProvider();this.fetchDataForProviders((a=>{a?(this.setState({data:a,state:R}),this.updatePageCount(a)):e===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.EDIT&&ft.includes(t)&&this.checkConnectStatusForProvider(t)}))}}fetchDataForProviders(e){const{websiteId:t,env:a}=this.props;let o=((e,t,a)=>a===i?`https://proxy.apps-api.instantpage.${N.reseller[e]}/v1/proxy/yotpo?websiteId=${t}`:`https://proxy.apps-api.instantpage.${N.reseller[e]}/v1/proxy/stats?id=${t}&source=${d[a]}`)(a,t,this.getProvider());if("production"!==String(a)){const e=window.location.search.indexOf("dummy=true");e>=0?(o=`${o}&${window.location.search.substring(e)}`,this.setState({dummyData:!0})):this.setState({dummyData:!1})}if("undefined"!=typeof XMLHttpRequest){const t=new XMLHttpRequest;t.onreadystatechange=()=>{if(4===t.readyState){if(200===t.status){const a=JSON.parse(t.responseText);return a.updateDate?(this.setState({providerState:T}),0===a.reviews.length?(this.setState({state:C}),void e(null)):(this.setState({state:R}),void e(a))):(this.setState({state:E,providerState:a.connected?T:f}),void e(null))}this.setState({state:v})}e(null)},t.open("GET",o,!0),t.send()}}checkConnectStatusForProvider(e){const{accountId:t,env:a,isReseller:o}=this.props;if("production"!==a&&this.state.dummyData)this.setState({providerState:T});else{const r=((e,t,a)=>`https://proxy.apps-api.instantpage.${a?N.reseller[e]:N.godaddy[e]}/v1/proxy/social?accountId=${t}`)(a,t,o);if("undefined"!=typeof XMLHttpRequest){const t=new XMLHttpRequest;t.onreadystatechange=()=>{if(4===t.readyState&&200===t.status){const a=JSON.parse(t.responseText);this.setConnectStatus(a,e)}},t.open("GET",r,!0),t.withCredentials=!0,t.send(null)}}}setConnectStatus(e){const t=e&&e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:n];if(t){const e=Object.keys(t)&&Object.keys(t)[0]||null,a=e&&t[e]&&t[e].status||f,o="PUBLISHED"===a?T:a;this.setState({providerState:o})}else this.setState({providerState:f})}componentDidUpdate(e,t){(this.props.providerType!==e.providerType||this.props.sourceType!==e.sourceType||this.props.sourceType===A&&!(global._||guac.lodash).isEqual(e.manualReviews,this.props.manualReviews)||this.state.cardsPerPage!==t.cardsPerPage)&&this.fetchData()}componentDidMount(){this.fetchData()}getProvider(){const{sourceType:e,providerType:t}=this.props;return e===A?s:t||Tt}updatePageCount(e){const{cardsPerPage:t}=this.state;let a=0;const o=e.reviews.length>9?9:e.reviews.length;o&&(a=Math.floor(o/t),a+=o/t%1>0?1:0),this.setState({pages:a})}getPageLink(e,t){if(t===s)return null;let a=y.base[t];return e&&e.metadata&&(e.metadata.pageId||e.metadata.link)&&(t===r?a=`${a}/${e.metadata.pageId}/reviews`:t===n?a=`${a}/maps?cid=${e.metadata.pageId}`:t===l?a=`${a}/${e.metadata.pageId}`:t===i&&(a=e.metadata.link||"/")),a}getCardHeight(){const{fontScale:e}=this.props;return Dt[e]}renderMobileCards(e,a){const{data:o,isMobile:r}=this.state,{renderMode:l,viewDevice:n,staticContent:i,market:s,sourceType:c}=this.props;if(!o.reviews)return null;const g=l===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PREVIEW&&"MOBILE_RENDER_DEVICE"===String(n)&&window.innerWidth>768,p=o.reviews.length>1,d=`${this.getCardHeight()}px`;return(global.React||guac.react).createElement(t.default,{slideHeight:d,viewportWidth:"100%",slideWidth:g?"290px":Ct,cellPadding:10,initialSlide:p?1:0,clickToNavigate:!1,infinite:p,dots:!1,arrows:!1,style:{slide:{opacity:"1",verticalAlign:"top"},selectedSlide:{opacity:"1"}}},(global._||guac.lodash).range(o.reviews.length).map((t=>o.reviews&&o.reviews[t]&&(global.React||guac.react).createElement(Rt,{desktopMobilePreview:g,key:`mobile-review-card-${t}`,data:o.reviews[t],provider:e,isMobile:r,market:s,staticContent:i,renderMode:l,link:a,sourceType:c,cardHeight:d}))))}getCards(){const{currentPage:e,data:t,isMobile:a,cardsPerPage:o}=this.state,{renderMode:r,staticContent:l,market:n,sourceType:i}=this.props,s=this.getProvider(),c=e*o,g=this.getPageLink(t,s);return a?this.renderMobileCards(s,g):(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid,{style:Pt.grid},(global._||guac.lodash).takeRight([c-3,c-2,c-1],o).map((e=>t.reviews&&t.reviews[e]&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid.Cell,{key:e,style:Pt.cell},(global.React||guac.react).createElement(Rt,{data:t.reviews[e],provider:s,isMobile:a,nextPageHandler:this.gotoPage(!0),previousPageHandler:this.gotoPage(!1),staticContent:l,market:n,renderMode:r,link:g,sourceType:i,cardHeight:`${this.getCardHeight()}px`})))))}getNavigationArrow(e){const{hasBgImage:t,category:a,section:o}=this.props;let r,l,n,i;return e===D?(r=(global._||guac.lodash).merge({},Pt.arrow,{right:"-35px"}),l=this.gotoPage(!0),n="chevronRight",i=tt.RIGHT_ARROW_RENDERED):(r=(global._||guac.lodash).merge({},Pt.arrow,{left:"-40px"}),l=this.gotoPage(!1),n="chevronLeft",i=tt.LEFT_ARROW_RENDERED),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{"data-aid":i,category:t?"accent":a,section:t?"overlay":o,onClick:l,style:r},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:n}))}getPaginationControl(){const{pages:e}=this.state;return e>1&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:Pt.paginationContainer},(global._||guac.lodash).range(e).map((t=>{const a=t+1;return e>=a?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:this.getPageDotStyles(a),onClick:this.updateCurrentPage(a)}):null})))}getConnectProviderHandler(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return()=>{const{isReseller:t,env:a,accountId:o,websiteId:r}=this.props,l=this.getProvider(),n=e?x:P;window.location.href=n[l].replace("{rootDomain}",((e,t)=>(t?N.reseller:N.godaddy)[e])(a,t)).replace("{accountId}",o).replace("{websiteId}",r).replace("{home}",window.location.href)}}renderMessageInContainer(e,t,a,o){if(!e)return null;const r={container:{display:"flex",flexDirection:"column",textAlign:"center",justifyContent:"center"},messageBlock:{paddingHorizontal:a?"xsmall":"xxlarge",paddingVertical:a?"large":"xlarger",margin:"auto",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",backgroundColor:"section"},icon:{width:"45px",height:"45px",marginBottom:"medium"}};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{style:r.container},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{category:"accent",section:"overlay",style:r.messageBlock},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,null,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:g[o],style:r.icon}),e)))}displayNoReviewsMessage(){const{section:e,staticContent:t,hasBgImage:a}=this.props,o={"data-aid":tt.REVIEWS_NO_DATA_RENDERED};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.PlaceholderMessage,{section:a?"overlay":"default"===e?"alt":"default",message:t.comingSoon,textProps:o})}displayMessages(e,t,a,o){const{isMobile:r}=this.state,{hasBgImage:l}=this.props,n=(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,null,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{style:{fontWeight:"bold"},children:e,"data-aid":a}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{style:{marginTop:"medium"},children:t,"data-aid":o}));return this.renderMessageInContainer(n,l,r,this.getProvider())}displayPendingMessage(){const{staticContent:e}=this.props;return this.displayMessages(e.txtPendingValidation,e.gmb3Days,tt.PENDING_VALIDATION_HEADER,tt.PENDING_VALIDATION_CONTENT)}displayWaitMessage(){const{staticContent:e}=this.props;return this.displayMessages(e.connectionSuccess,e.twentyFourHourLag,tt.WAITING_FOR_DATA_HEADER,tt.WAITING_FOR_DATA_CONTENT)}displayConnectOrUpgradeMessage(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{staticContent:t,renderMode:a,publishDate:o,publishAfterLastUpgrade:r}=this.props,l=this.getProvider(),n=ft.concat(Nt).includes(l)&&(!o||r),i=m[l],s={renderMode:a,beforeContent:(global.React||guac.react).createElement((global.React||guac.react).Fragment,null,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:g[l],style:{width:"45px",height:"45px",marginBottom:"medium"}}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{typography:"none",children:t[e?"upgradeMessage":"connectMsg"].replace("{provider}",i),"data-aid":e?tt.UPGRADE_TIER_MSG:tt.REVIEWS_NOT_CONNECTED_MSG}),n&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{marginTop:"medium"}},t.publishMessage.replace("{provider}",i))),button:{typography:"none",style:n?{opacity:"0.6",pointerEvents:"none"}:{opacity:"1"},onClick:e?this.getConnectProviderHandler(!0):this.getConnectProviderHandler(),children:t[e?"upgradeNow":"connectBtnText"].replace("{provider}",i),"data-event":c[l],"data-aid":tt.REVIEWS_CONNECT_BUTTON}};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.ZeroStateOverlay,s)}renderReviews(){const{data:e,isMobile:t}=this.state,a=e.reviews&&e.reviews.length>this.state.cardsPerPage;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:Pt.container},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:Pt.cardsContainer},!t&&a&&this.getNavigationArrow(I),this.getCards(),!t&&a&&this.getNavigationArrow(D)),!t&&this.getPaginationControl())}showWaitMessage(){const{state:e,providerState:t}=this.state,{renderMode:a,gmbShowPendingMessage:o,fbPageId:s}=this.props,c=this.getProvider();return a===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.EDIT&&e===E&&(c===n?t===T&&!o:c===r?!!s:(c===l||c===i)&&t===T)}isProviderNotSetup(e){const{providerState:t,planUpgradeRequired:a}=this.state;if(a)return!1;return ft.concat(Nt).includes(e)?!(t===T):e===r?!this.props.fbPageId:e!==s}providerHasReviews(e){const{manualReviews:t}=this.props;return e===s?t&&t.length:this.state.state===R}getContainerStyles(e){const{renderMode:t}=this.props;let a="50px";t!==(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.EDIT&&(a=e?"unset":"500px");return{display:"flex",flexDirection:"column",minHeight:a}}displayReviewBar(e,t){const{staticContent:a,hasBgImage:r}=this.props,{isMobile:l,data:n,state:i}=this.state,s=n&&n.metadata&&n.metadata.name||"";return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{style:e},(global.React||guac.react).createElement(nt,o({},this.props,{hasBgImage:r,overallRating:n.overallRating||0,businessName:s,provider:t,staticContent:a,isMobile:l,pageLink:this.getPageLink(n,t),totalReviews:n.totalReviews||0,negativeRecommendations:n.negativeRecommendations||0,positiveRecommendations:n.positiveRecommendations||0})),i===w?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Loader,{"data-aid":tt.REVIEWS_LOADER,style:{margin:"0 auto"}}):this.renderReviews())}render(){const{state:e,planUpgradeRequired:t}=this.state,{hasBgImage:a,gmbShowPendingMessage:o,renderMode:r,category:l,section:n}=this.props,i=this.getProvider(),s=this.providerHasReviews(i),c=this.isProviderNotSetup(i),g=o&&!s&&r===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.EDIT,p=e===C||r!==(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.EDIT&&e===E,d=this.getContainerStyles(p);return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{category:a?"accent":l,section:a?"overlay":n,style:d,group:"Group"},(global.React||guac.react).createElement(vt,{onChange:this.handleMatchMedia}),s&&this.displayReviewBar(d,i),t&&this.displayConnectOrUpgradeMessage(!0),this.showWaitMessage()&&this.displayWaitMessage(),p&&this.displayNoReviewsMessage(),!s&&c&&this.displayConnectOrUpgradeMessage(),g&&this.displayPendingMessage())}}a(xt,"propTypes",{viewDevice:(global.PropTypes||guac["prop-types"]).string.isRequired,renderMode:(global.PropTypes||guac["prop-types"]).string.isRequired,websiteId:(global.PropTypes||guac["prop-types"]).string.isRequired,accountId:(global.PropTypes||guac["prop-types"]).string.isRequired,isReseller:(global.PropTypes||guac["prop-types"]).bool.isRequired,env:(global.PropTypes||guac["prop-types"]).string.isRequired,staticContent:(global.PropTypes||guac["prop-types"]).object,hasBgImage:(global.PropTypes||guac["prop-types"]).bool,publishDate:(global.PropTypes||guac["prop-types"]).string,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,gmbShowPendingMessage:(global.PropTypes||guac["prop-types"]).bool,providerType:(global.PropTypes||guac["prop-types"]).string,fbPageId:(global.PropTypes||guac["prop-types"]).string,fontScale:(global.PropTypes||guac["prop-types"]).string,planType:(global.PropTypes||guac["prop-types"]).string,publishAfterLastUpgrade:(global.PropTypes||guac["prop-types"]).bool,sourceType:(global.PropTypes||guac["prop-types"]).string,manualReviews:(global.PropTypes||guac["prop-types"]).array,market:(global.PropTypes||guac["prop-types"]).string});const{components:{Bootstrap:St}}=global.Core||guac["@wsb/guac-widget-core"];function Ot(e){return(global.React||guac.react).createElement(St.Radpack,o({},e,{Component:xt,entry:"@widget/REVIEWS/bs-Component",renderMode:e.renderMode}))}Ot.propTypes={renderMode:(global.PropTypes||guac["prop-types"]).string};const{Widget:kt}=(global.Core||guac["@wsb/guac-widget-core"]).components;class _t extends kt{renderHeadlineSection(e,t,a){return e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Heading,{"data-aid":tt.REVIEWS_SECTION_TITLE_RENDERED,"data-route":"sectionTitle",isInternalPage:t,order:a},e):null}renderReviews(e){return(global.React||guac.react).createElement(Ot,o({hasBgImage:e},this.props))}render(){const{background:e,isInternalPage:t,order:a,section:o,sectionTitle:r,category:l}=this.props,n=!(!e||!e.image),i={"data-aid":tt.SECTION_BACKGROUND,imageData:e,style:{position:e.position,backgroundSize:"cover"}},s={section:{paddingVertical:"xlarge","@md":{paddingVertical:"xxlarge"}},container:{paddingHorizontal:0},group:{marginTop:"-xxsmall","@md":{marginTop:"0"}}};return e&&e.alt&&(i.title=e.alt),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Widget.Banner,this.props,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Background,i,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Group.Section.Banner,{category:n?"accent":l,section:n?"overlay":o,style:s.section},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,{style:s.container},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:s.group},this.renderHeadlineSection(r,t,a),this.renderReviews(n))))))}}a(_t,"propTypes",{isInternalPage:(global.PropTypes||guac["prop-types"]).bool,sectionTitle:(global.PropTypes||guac["prop-types"]).string,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,background:(global.PropTypes||guac["prop-types"]).object}),a(_t,"defaultProps",{category:"neutral"});const{Widget:Mt}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;class Ut extends Mt{render(){return(global.React||guac.react).createElement(_t,this.props)}}a(Ut,"propTypes",{...Mt.propTypes,...O}),a(Ut,"defaultProps",{...Mt.defaultProps,...pe});var Wt=(global.Core||guac["@wsb/guac-widget-core"]).Maniless.connect(Ut,et);e.Component=Wt,e.component="@widget/REVIEWS/reviews1",e.default=Wt,e.hooks="@widget/REVIEWS/hooks",e.id="reviews1",e.src="/home/jenkins/workspace/gdcorp-im/guac-widget-reviews/build-master/src/reviews1/index.js",e.type="REVIEWS",Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.global=window);
//# sourceMappingURL=reviews1-68540c26.js.map
